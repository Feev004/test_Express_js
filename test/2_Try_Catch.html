<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="test"></div>
    <script>
      async function getProducts() {
        console.log("กำลังเริ่มดึงข้อมูล...");
        try {
          const response = await fetch("http://localhost:3000/products");
          if (!response.ok) {
            throw new Error("ติดต่อ Server ไม่ได้ หรือไม่พบข้อมูล");
          }
          const data = await response.json();
          console.log("ดึงข้อมูลสำเร็จ:", data);
          const test = document.getElementById("test");
          test.innerHTML = data
            .map(
              (item) =>
                `<div><h2>${item.name}</h2><p>ราคา: ${item.price} บาท</p></div>`,
            )
            .join("<hr>");
        } catch (error) {
          console.error("เกิดข้อผิดพลาดร้ายแรง: " + error.message);
          alert("ไม่สามารถโหลดข้อมูลสินค้าได้ในขณะนี้ กรุณาลองใหม่ภายหลัง");
        } finally {
          console.log("จบการทำงานของฟังก์ชัน");
        }
      }
      getProducts();
    </script>
  </body>
</html>
